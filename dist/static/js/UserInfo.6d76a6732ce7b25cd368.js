webpackJsonp([19],{IRAW:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mvHQ"),s=a.n(r),n=a("BO1k"),i=a.n(n),o=a("HGcE"),l=a("kq1e"),c={name:"RoleManagementForm",props:["roleMgmtVisible","formTitle","roleMgmtTabCtntList","currentUserId","defaultCheckedRoles"],data:function(){return{checkedAccessArr:[]}},computed:{isShowDialog:{get:function(){return this.roleMgmtVisible},set:function(e){}},dialogFormTitle:{get:function(){return this.formTitle},set:function(e){}}},watch:{defaultCheckedRoles:function(e){var t=this;setTimeout(function(){e.forEach(function(e){t.$refs.checkboxRoleTable.toggleRowSelection(e,!0)})},500)}},methods:{handleClose:function(e){var t=this;this.$confirm("确认关闭？").then(function(a){e();t.$emit("handlUpdateForm",{isVisible:!1,actionType:"Cancel"})}).catch(function(e){})},submitForm:function(e){var t={isVisible:!1,actionType:"Submit",checkedAccessArr:this.checkedAccessArr};this.$emit("handlUpdateForm",t)},handleCancel:function(){this.$emit("handlUpdateForm",!1)},handleSelectionChange:function(e){this.checkedAccessArr=[];var t=!0,a=!1,r=void 0;try{for(var s,n=i()(e);!(t=(s=n.next()).done);t=!0){var o=s.value;this.checkedAccessArr.push({UserId:this.currentUserId,RoleId:o.RoleId})}}catch(e){a=!0,r=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw r}}},isSelectedRole:function(e,t){return e.isSelectedRole}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"role-management-dialog-class",attrs:{title:e.dialogFormTitle,visible:e.isShowDialog,"before-close":e.handleClose},on:{"update:visible":function(t){e.isShowDialog=t}}},[a("el-table",{ref:"checkboxRoleTable",staticStyle:{width:"100%"},attrs:{data:e.roleMgmtTabCtntList.TabCtnt,"tooltip-effect":"dark","default-sort":{prop:"date",order:"descending"},height:"400"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),e._l(e.roleMgmtTabCtntList.tabHeader,function(e,t){return a("el-table-column",{key:t,attrs:{prop:e.headerKey,label:e.headerVal,sortable:""}})})],2),e._v(" "),a("div",{staticClass:"role-management-dialog-btn"},[a("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),a("el-button",{staticClass:"submitBtn",attrs:{type:"primary"},on:{click:function(t){e.submitForm()}}},[e._v("提交")])],1)],1)},staticRenderFns:[]};var m=a("VU/8")(c,d,!1,function(e){a("vJDj")},null,null).exports,h=a("F+jZ"),b=a("L2rX"),u={name:"UserInfo",components:{MultiLevelNoTabComponent:o.a,OperationUserInfoForm:l.a,RoleManagementForm:m},data:function(){return{getUserBaseInfoUrl:b.b.rootUrl+b.b.BaseInfoAPI.GetUserBaseInfo,getRoleToUserDataUrl:b.b.rootUrl+b.b.BaseInfoAPI.GetRoleToUserData,postAddObj:{params:{LoginCode:"",NickName:"",UnitId:"",Tel:"",Fax:"",Email:"",Notes:""},postUrl:b.b.rootUrl+b.b.BaseInfoAPI.AddUserInfo},postUpdateObj:{params:{LoginCode:"",NickName:"",UnitId:"",Tel:"",Fax:"",Email:"",Notes:"",UserID:"",LoginPass:""},postUrl:b.b.rootUrl+b.b.BaseInfoAPI.UpdateUserInfo},postDeleteObj:{params:{userId:""},postUrl:b.b.rootUrl+b.b.BaseInfoAPI.DeleteUser},postResetObj:{params:{userId:""},postUrl:b.b.rootUrl+b.b.BaseInfoAPI.updateUserLoginPass},exportCheckManageDataUrl:b.b.rootUrl+b.b.ExportCheckManageData,columnFullScore:{rwl:5,sxl:10,wxpyl:15,gjwzl:40,sjhgl:30,pjcscs:0,pjpjsc:0},columnType:{text:"text",router_link:"router_link"},userInfoSourceData:[],countData:[],addUserInfoVisible:!1,updateUserInfoVisible:!1,deleteUserInfoVisible:!1,resetUserInfoVisible:!1,roleMgmtVisible:!1,formData:[{headerKey:"LoginCode",headerVal:"用户名",isReadOnly:!0,columnType:"input",compVal:""},{headerKey:"NickName",headerVal:"昵称",isReadOnly:!1,columnType:"input",compVal:""},{headerKey:"UnitId",headerVal:"运营机构",isReadOnly:!1,columnType:"preSearch",compVal:"",compId:""},{headerKey:"Tel",headerVal:"电话",isReadOnly:!1,columnType:"input",compVal:""},{headerKey:"Fax",headerVal:"传真",isReadOnly:!1,columnType:"input",compVal:""},{headerKey:"Email",headerVal:"邮件",isReadOnly:!1,columnType:"input",compVal:""},{headerKey:"Notes",headerVal:"备注",isReadOnly:!1,columnType:"input",compVal:""}],formTitle:"增加用户管理信息",formUpdateTitle:"修改用户管理信息",formDeleteTitle:"你确定要删除该用户吗？",formResetTitle:"你确定要为该用户初始化密码吗？",formRoleMgmtTitle:"角色配置: ",isSelectedRow:!1,roleMgmtTabCtntList:{tabHeader:[{headerKey:"Name",headerVal:"角色名称",subHeaders:[]},{headerKey:"Code",headerVal:"角色代码",subHeaders:[]}],TabCtnt:[]},currentUserId:"",defaultCheckedRoles:[]}},computed:{tabCtntList:function(){return{currentPage:1,total:0,loading:!1,btnEvents:[{iconName:"el-icon-search",btnId:b.b.btnEventsId.search,btnName:"查询",isDisabled:!1,ctrlId:"jbxx_yhgl_cx"},{iconName:"el-icon-circle-plus-outline",btnId:b.b.btnEventsId.add,btnName:"增加",isDisabled:!1,ctrlId:"jbxx_yhgl_zj"},{iconName:"el-icon-edit",btnId:b.b.btnEventsId.edit,btnName:"修改",isDisabled:!1,ctrlId:"jbxx_yhgl_xg"},{iconName:"el-icon-delete",btnId:b.b.btnEventsId.delete,btnName:"删除",isDisabled:!1,ctrlId:"jbxx_yhgl_sc"},{iconName:"el-icon-refresh",btnId:b.b.btnEventsId.initpwd,btnName:"初始化密码",isDisabled:!1,ctrlId:"jbxx_yhgl_cshmm"},{iconName:"el-icon-setting",btnId:b.b.btnEventsId.rolemgmnt,btnName:"角色配置",isDisabled:!1,ctrlId:"jbxx_yhgl_jspz"}],searchCreteria:[{searchType:"input",labelName:"用户名",labelId:b.d.Name,compVal:""},{searchType:"input",labelName:"运营机构",labelId:b.d.UnitId,compVal:"",compId:""}],tabHeader:[{headerKey:"sybid",headerVal:"序号",subHeaders:[]},{headerKey:"LoginCode",headerVal:"用户名",subHeaders:[]},{headerKey:"NickName",headerVal:"昵称",subHeaders:[]},{headerKey:"UnitName",headerVal:"运营机构",subHeaders:[]},{headerKey:"Tel",headerVal:"电话",subHeaders:[]},{headerKey:"Fax",headerVal:"传真",subHeaders:[]},{headerKey:"Email",headerVal:"邮件",subHeaders:[]},{headerKey:"Notes",headerVal:"备注",subHeaders:[]}],TabCtnt:[]}}},methods:{handleClickSearch:function(e){var t=this;h.q.setItem(b.b.ctrlId,"jbxx_yhgl_cx"),this.isSelectedRow=!1;var a=t.formPageParams(e.searchCreteria,e.currentPage,e.isSplitPage);t.tabCtntList.loading=!0,t.userInfoSourceData=[],h.a.axiosGet(this.getUserBaseInfoUrl,a).then(function(e){var a=e.data.DetailList,r=!0,s=!1,n=void 0;try{for(var o,l=i()(a);!(r=(o=l.next()).done);r=!0){var c=o.value;t.userInfoSourceData.push(t.pushSourceData(c))}}catch(e){s=!0,n=e}finally{try{!r&&l.return&&l.return()}finally{if(s)throw n}}t.tabCtntList.TabCtnt=t.userInfoSourceData,t.tabCtntList.total=e.data.CountTotal,t.tabCtntList.loading=!1,t.tabCtntList.btnEvents[1].isDisabled=!1}).catch(function(e){t.$message.error(Object(h.l)(e))})},pushSourceData:function(e){return{sybid:e.sybid,LoginCode:e.LoginCode,UserID:e.UserID,UnitID:e.UnitID,LoginPass:e.LoginPass,NickName:e.NickName,UnitName:e.UnitName,Tel:e.Tel,Fax:e.Fax,Email:e.Email,Notes:e.Notes}},handleClickExpData:function(e){var t=this;t.tabCtntList.loading=!0;var a=t.formPageParams(e.searchCreteria,e.currentPage,e.isSplitPage);h.a.axiosGet(this.exportCheckManageDataUrl,a).then(function(e){t.downloadServerFile(decodeURIComponent(e.data)),t.tabCtntList.loading=!1}).catch(function(e){t.$message.error(Object(h.l)(e))})},formPageParams:function(e,t,a){var r="",s="",n=!0,o=!1,l=void 0;try{for(var c,d=i()(e);!(n=(c=d.next()).done);n=!0){var m=c.value;switch(m.labelId){case b.d.Name:s=m.compVal||null;break;case b.d.UnitId:r=m.compId}}}catch(e){o=!0,l=e}finally{try{!n&&d.return&&d.return()}finally{if(o)throw l}}return{name:s,unitId:r,pageSize:10,pageIndex:t,isSplitPage:a,readPage:""}},handleCurrentChange:function(e){this.handleClickSearch(e)},downloadServerFile:function(e){var t=document.createElement("a");t.href=e,t.click()},handleEditBtn:function(e){this.isSelectedRow?this.updateUserInfoVisible=e:this.$message.error("请选择一行数据")},handleDeleteBtn:function(e){this.isSelectedRow?this.deleteUserInfoVisible=e:this.$message.error("请选择一行数据")},handleInitpwdBtn:function(e){this.isSelectedRow?this.resetUserInfoVisible=e:this.$message.error("请选择一行数据")},handleRoleMgmtBtn:function(e){var t=this;if(this.isSelectedRow){h.q.setItem(b.b.ctrlId,"jbxx_yhgl_jspz");var a={userId:this.currentUserId};h.a.axiosGet(this.getRoleToUserDataUrl,a).then(function(e){var a=e.data;for(var r in t.roleMgmtTabCtntList.TabCtnt=[],t.defaultCheckedRoles=[],a){var s=!1;Object(h.o)(a[r].Role)||(s=!0),t.roleMgmtTabCtntList.TabCtnt.push({Code:a[r].Code,Name:a[r].Name,Role:a[r].Role,RoleId:a[r].RoleId,State:a[r].State,isSelectedRole:s}),Object(h.o)(a[r].Role)||t.defaultCheckedRoles.push(t.roleMgmtTabCtntList.TabCtnt[r])}}).catch(function(e){t.$message.error(Object(h.l)(e))}),this.roleMgmtVisible=e}else this.$message.error("请选择一行数据")},handleAddEvent:function(e){this.addUserInfoVisible=e;var t=!0,a=!1,r=void 0;try{for(var s,n=i()(this.formData);!(t=(s=n.next()).done);t=!0){var o=s.value;switch(o.headerKey){case"LoginCode":case"NickName":o.compVal="";break;case"UnitId":o.compVal="",o.compId="";break;case"Tel":case"Fax":case"Email":case"Notes":o.compVal=""}}}catch(e){a=!0,r=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw r}}console.log(this.formData)},handleAddCancelSubmitEvent:function(e){var t=this;if(this.addUserInfoVisible=e.isVisible,"Submit"===e.actionType){h.q.setItem(b.b.ctrlId,"jbxx_yhgl_zj");var a=!0,r=!1,s=void 0;try{for(var n,o=i()(e.formColumnNames);!(a=(n=o.next()).done);a=!0){var l=n.value;switch(l.headerKey){case"LoginCode":t.postAddObj.params.LoginCode=l.compVal;break;case"NickName":t.postAddObj.params.NickName=l.compVal;break;case"UnitId":t.postAddObj.params.UnitId=l.compId;break;case"Tel":t.postAddObj.params.Tel=l.compVal;break;case"Fax":t.postAddObj.params.Fax=l.compVal;break;case"Email":t.postAddObj.params.Email=l.compVal;break;case"Notes":t.postAddObj.params.Notes=l.compVal}}}catch(e){r=!0,s=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw s}}h.a.axiosPost(t.postAddObj).then(function(e){0===e.data?(t.$message({message:"恭喜你，增加用户信息成功",type:"success"}),t.addUserInfoVisible=!1,t.handleClickSearch({currentPage:1,searchCreteria:t.tabCtntList.searchCreteria,isSplitPage:!0}),t.tabCtntList.currentPage=1):-1===e.data?(t.addUserInfoVisible=!0,t.$message.error("用户名已存在，请重新添加")):(t.addUserInfoVisible=!0,t.$message.error("错了哦，增加用户信息失败"))}).catch(function(e){t.$message.error(Object(h.l)(e))})}},handleUpdateCancelSubmitEvent:function(e){var t=this;if(this.updateUserInfoVisible=e.isVisible,"Submit"===e.actionType){h.q.setItem(b.b.ctrlId,"jbxx_yhgl_xg");var a=!0,r=!1,s=void 0;try{for(var n,o=i()(e.formColumnNames);!(a=(n=o.next()).done);a=!0){var l=n.value;switch(l.headerKey){case"LoginCode":t.postUpdateObj.params.LoginCode=l.compVal;break;case"NickName":t.postUpdateObj.params.NickName=l.compVal;break;case"UnitId":t.postUpdateObj.params.UnitId=l.compId;break;case"Tel":t.postUpdateObj.params.Tel=l.compVal;break;case"Fax":t.postUpdateObj.params.Fax=l.compVal;break;case"Email":t.postUpdateObj.params.Email=l.compVal;break;case"Notes":t.postUpdateObj.params.Notes=l.compVal}}}catch(e){r=!0,s=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw s}}h.a.axiosPost(t.postUpdateObj).then(function(e){e.data?(t.$message({message:"恭喜你，修改用户信息成功",type:"success"}),t.updateUserInfoVisible=!1,t.handleClickSearch({currentPage:1,searchCreteria:t.tabCtntList.searchCreteria,isSplitPage:!0}),t.tabCtntList.currentPage=1):(t.updateUserInfoVisible=!0,t.$message.error("错了哦，修改用户信息失败"))}).catch(function(e){t.$message.error(Object(h.l)(e))})}},handleDeleteCancelSubmitEvent:function(e){var t=this;this.deleteUserInfoVisible=e.isVisible,"Submit"===e.actionType&&(h.q.setItem(b.b.ctrlId,"jbxx_yhgl_sc"),h.a.axiosPost(t.postDeleteObj).then(function(e){e.data?(t.$message({message:"恭喜你，删除用户信息成功",type:"success"}),t.deleteUserInfoVisible=!1,t.handleClickSearch({currentPage:1,searchCreteria:t.tabCtntList.searchCreteria,isSplitPage:!0}),t.tabCtntList.currentPage=1):(t.deleteUserInfoVisible=!0,t.$message.error("错了哦，删除用户信息失败"))}).catch(function(e){}))},handleResetCancelSubmitEvent:function(e){var t=this;this.resetUserInfoVisible=e.isVisible,"Submit"===e.actionType&&(h.q.setItem(b.b.ctrlId,"jbxx_yhgl_cshmm"),h.a.axiosPost(t.postResetObj).then(function(e){e.data?(t.$message({message:"恭喜你，重置信息成功",type:"success"}),t.resetUserInfoVisible=!1,t.handleClickSearch({currentPage:1,searchCreteria:t.tabCtntList.searchCreteria,isSplitPage:!0}),t.tabCtntList.currentPage=1):(t.resetUserInfoVisible=!0,t.$message.error("错了哦，重置信息失败"))}).catch(function(e){t.$message.error(Object(h.l)(e))}))},handleRoleMgmtCancelSubmitEvent:function(e){var t=this;this.roleMgmtVisible=e.isVisible,"Submit"===e.actionType&&(h.q.setItem(b.b.ctrlId,"jbxx_yhgl_jspz"),this.postRoleMgmtObj={params:{list:s()(e.checkedAccessArr),userId:t.currentUserId},postUrl:b.b.rootUrl+b.b.BaseInfoAPI.SaveRoleToUserData},h.a.axiosPost(t.postRoleMgmtObj).then(function(e){e.data?(t.$message({message:"恭喜你，修改角色配置信息成功",type:"success"}),t.roleMgmtVisible=!1,t.handleClickSearch({currentPage:1,searchCreteria:t.tabCtntList.searchCreteria,isSplitPage:!0}),t.tabCtntList.currentPage=1):(t.$message.error("错了哦，修改角色配置信息失败"),t.roleMgmtVisible=!0)}).catch(function(e){t.$message.error(Object(h.l)(e))}))},handleRowClick:function(e){this.isSelectedRow=!0,this.postUpdateObj.params.UnitId=e.UnitID;var t=!0,a=!1,r=void 0;try{for(var s,n=i()(this.formData);!(t=(s=n.next()).done);t=!0){var o=s.value;switch(o.headerKey){case"LoginCode":o.compVal=e.LoginCode;break;case"NickName":o.compVal=e.NickName;break;case"UnitId":o.compVal=e.UnitName,o.compId=e.UnitID;break;case"Tel":o.compVal=e.Tel;break;case"Fax":o.compVal=e.Fax;break;case"Email":o.compVal=e.Email;break;case"Notes":o.compVal=e.Notes}}}catch(e){a=!0,r=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw r}}this.postUpdateObj.params.UserID=e.UserID,this.postUpdateObj.params.LoginPass=e.LoginPass,this.postDeleteObj.params.userId=e.UserID,this.postResetObj.params.userId=e.UserID,this.formRoleMgmtTitle="角色配置: ",this.formRoleMgmtTitle+=e.LoginCode,this.currentUserId=e.UserID}},beforeMount:function(){var e=JSON.parse(h.q.getItem("breadNavs"));this.$emit("viewIn",e)}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-info"},[a("multi-level-no-tab-component",{staticClass:"user-info-multilevel",attrs:{tabCtntList:e.tabCtntList},on:{handleClickSearch:e.handleClickSearch,handleClickExpData:e.handleClickExpData,handleCurrentChange:e.handleCurrentChange,handleEditBtn:e.handleEditBtn,handleAddEvent:e.handleAddEvent,handleRowClick:e.handleRowClick,handleDeleteBtn:e.handleDeleteBtn,handleInitpwdBtn:e.handleInitpwdBtn,handleRoleMgmtBtn:e.handleRoleMgmtBtn}}),e._v(" "),a("operation-user-info-form",{attrs:{updateCompanyFormVisible:e.addUserInfoVisible,formData:e.formData,formTitle:e.formTitle},on:{handlUpdateForm:e.handleAddCancelSubmitEvent}}),e._v(" "),a("operation-user-info-form",{attrs:{updateCompanyFormVisible:e.updateUserInfoVisible,formData:e.formData,formTitle:e.formUpdateTitle},on:{handlUpdateForm:e.handleUpdateCancelSubmitEvent}}),e._v(" "),a("operation-user-info-form",{attrs:{updateCompanyFormVisible:e.deleteUserInfoVisible,formTitle:e.formDeleteTitle},on:{handlUpdateForm:e.handleDeleteCancelSubmitEvent}}),e._v(" "),a("operation-user-info-form",{attrs:{updateCompanyFormVisible:e.resetUserInfoVisible,formTitle:e.formResetTitle},on:{handlUpdateForm:e.handleResetCancelSubmitEvent}}),e._v(" "),a("role-management-form",{attrs:{roleMgmtVisible:e.roleMgmtVisible,formTitle:e.formRoleMgmtTitle,currentUserId:e.currentUserId,roleMgmtTabCtntList:e.roleMgmtTabCtntList,defaultCheckedRoles:e.defaultCheckedRoles},on:{handlUpdateForm:e.handleRoleMgmtCancelSubmitEvent}})],1)},staticRenderFns:[]};var f=a("VU/8")(u,p,!1,function(e){a("d3Cw")},null,null);t.default=f.exports},d3Cw:function(e,t){},vJDj:function(e,t){}});
//# sourceMappingURL=UserInfo.6d76a6732ce7b25cd368.js.map